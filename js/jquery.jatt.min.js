/*
 * Jatt - just another tooltip v2.7 min
 * http://github.com/Mottie/Jatt
 * by Rob Garrison (aka Mottie)
 *
 * based on tooltip by Alen Grakalic (http://cssglobe.com/post/1695/easiest-tooltip-and-image-preview-using-jquery)
 * tooltip modification by Rob G, aka Mottie (http://wowmotty.blogspot.com/)
 *
 */

(function(a){a.jatt=function(u){var i,r,s=[],t=a("body"),c=a.extend({},a.jatt.defaultOptions,u);a.jatt.ttrelocate=function(k,h){var g=a(window),d=a("#"+h),e=d.outerWidth(),f=d.outerHeight(),b=d.data("options")||c,j={e:[b.xOffset,-f/2,e+b.xOffset,f/2],se:[b.xOffset,b.yOffset,e+b.xOffset,f+b.yOffset],s:[-e/2,b.yOffset,e/2,f+b.yOffset],sw:[-e-b.xOffset,b.yOffset,-b.xOffset,f+b.yOffset],w:[-e-b.xOffset,-f/2,-b.xOffset,f/2],nw:[-e-b.xOffset,-f-b.yOffset,-b.xOffset,-b.yOffset],n:[-e/2,-f-b.yOffset,e/2, -b.yOffset],ne:[b.xOffset,-f-b.yOffset,e+b.xOffset,-b.yOffset]}[b.direction],p=g.scrollTop(),n=g.scrollLeft(),m=a(k.target),o=k.pageX||m.position().left+m.width()/2,l=k.pageY||m.position().top+m.height()/2;if(!b.followMouse){o=m.outerWidth();l=m.outerHeight();l={e:[o,l/2],se:[o,l],s:[o/2,l],sw:[0,l],w:[0,l/2],nw:[0,0],n:[o/2,0],ne:[o,0]};o=m.offset().left+l[b.direction][0];l=m.offset().top+l[b.direction][1]}m=o+j[0];var q=l+j[1];if(o+j[2]>n+g.width()-b.xOffset)m=g.width()-e-b.xOffset;if(l+j[3]>p+ g.height()-b.yOffset)q=l-f-b.yOffset;if(m<n+b.xOffset)m=n+b.xOffset;if(q<p+b.yOffset)q=l+b.yOffset;if(o>m&&o<m+e&&l>q&&l<q+f)q+=q-f/2-b.yOffset<p+b.yOffset?f/2+b.yOffset:-f/2-b.yOffset;d.css({left:m+"px",top:q+"px"})};a.jatt.getMeta=function(k){i=a.extend({},c);var h,g=[],d=k.attr(c.metadata).match(/(\{.*\})/g)||"";if(d!==""){d=d[0].replace(/(\{|\'|\"|\})/g,"");if(d.match("direction|followMouse|content|speed|local|xOffset|yOffset|zIndex")){a.each(d.split(";"),function(e,f){h=f.split(":");if(h[0].match("direction|followMouse|content|speed|local|xOffset|yOffset|zIndex")){var b= a.trim(h[0]),j=a.trim(h[1]);i[b]=j=="true"||j=="false"?j=="true"?true:false:isNaN(j)?j:parseFloat(j)}else g.push(f)});d=g.join(";")}}h=k.attr("rel")||"";if(h!==""&&!/^[#|\.]|[\/]/.test(h)){h=h.split(",");d+=";width:"+h[0]+"px;";if(typeof h[1]!="undefined")d+="background:"+h[1]}return[i,d]};a.jatt.removeTooltips=function(){for(a("#"+c.previewId+", #"+c.tooltipId).remove();a("#"+c.previewId+", #"+c.tooltipId).length>0;)a("#"+c.previewId+", #"+c.tooltipId).remove()};a.jatt.preloadContent=function(k){for(var h, g,d,e,f=[],b=a(c.tooltip),j=k.length;j--;){h=document.createElement("img");h.src=k[j];s.push(h)}b.each(function(p){g=a(this);if(this.tagName=="A"&&g.is(c.preloadContent)){e=a(this).attr("href")||"";if(e!==""&&!e.match(/^#/)){d=a('<div rel="'+p+'" />');f.push(d);d.load(e,function(){b.eq(d.attr("rel")).data("tooltip",d.html())})}}})};(function(){var k=c.live?"live":"bind",h=[];a(c.tooltip)[k](c.activate,function(g){var d,e,f,b,j,p,n=a(this);d=c.metadata.toString()=="false"?[c,""]:a.jatt.getMeta(n); i=d[0];e=n.attr(i.content)===""?n.data("tooltip")||"":n.attr(i.content)||"";f=n.attr("rel")||"";b=n.attr("href")||"";n.data("tooltip",e);n.attr("title","");d='<div id="'+c.tooltipId+'" style="position:absolute;z-index:'+i.zIndex+";"+d[1]+'"></div>';i.local?n.before(d):t.append(d);if(e==="")if(f!=="")e=a(f).html()||c.notFound;else if(b!==""){e=c.loading;j=a("<div />");j.load(b,function(){p=j.html();s=c.cacheData?p:"";a("#"+c.tooltipId).hide().html(p);n.data("tooltip",s);a.jatt.ttrelocate(g,c.tooltipId); a("#"+c.tooltipId).show()})}a("#"+c.tooltipId).html(e).data("options",i);a.jatt.ttrelocate(g,c.tooltipId);a("#"+c.tooltipId).fadeIn(i.speed)})[k](c.deactivate,function(){a.jatt.removeTooltips()})[k]("mousemove",function(g){a("#"+c.tooltipId).length&&i.followMouse&&a.jatt.ttrelocate(g,c.tooltipId)});r=function(g,d,e){var f,b=c.metadata.toString()=="false"?[c,""]:a.jatt.getMeta(d);i=b[0];f=d.attr(i.content)===""?d.data("tooltip")||"":d.attr(i.content)||"";d.data("tooltip",f);i.content=="title"&&d.attr(i.content, "");e='<div id="'+c.previewId+'" style="position:absolute;z-index:'+i.zIndex+";"+b[1]+'"><img src="'+e;e+=f!==""?"<br/>"+f+"</div>":"</div>";i.local?d.before(e):t.append(e);a("#"+c.previewId).hide().data("options",i).fadeIn(i.speed);a.jatt.ttrelocate(g,c.previewId)};a(c.preview)[k](c.activate,function(g){r(g,a(this),a(this).attr("href")+'" alt="'+c.imagePreview+'" />')}).each(function(){h.push(a(this).attr("href"))});a(c.screenshot)[k](c.activate,function(g){var d=a(this),e=d.attr("rel")=="#"?"http://images.websnapr.com/?url="+ d.attr("href"):d.attr("rel");e+='" alt="'+c.siteScreenshot+d.attr("href")+'" />';r(g,d,e)}).each(function(){var g=a(this);h.push(g.attr("rel")=="#"?"http://images.websnapr.com/?url="+g.attr("href"):g.attr("rel"))});a(c.preview+","+c.screenshot)[k](c.deactivate,function(){a.jatt.removeTooltips()})[k]("mousemove",function(g){a("#"+c.previewId).length&&i.followMouse&&a.jatt.ttrelocate(g,c.previewId)});a.jatt.preloadContent(h)})()};a.jatt.defaultOptions={direction:"n",followMouse:true,content:"title", speed:300,local:false,xOffset:20,yOffset:20,zIndex:1E3,live:false,metadata:"class",activate:"mouseenter focusin",deactivate:"mouseleave focusout",cacheData:true,loading:"Loading...",notFound:"No tooltip found",imagePreview:"Image preview",siteScreenshot:"URL preview: ",tooltip:".tooltip",screenshot:"a.screenshot",preview:"a.preview",preloadContent:".preload",tooltipId:"tooltip",previewId:"preview"}})(jQuery);
