/*!
 * Jatt - just another tooltip v2.8.5 min
 * http://github.com/Mottie/Jatt
 * by Rob Garrison (aka Mottie)
 *
 * based on tooltip by Alen Grakalic (http://cssglobe.com/post/1695/easiest-tooltip-and-image-preview-using-jquery)
 * tooltip modification by Rob G, aka Mottie (http://wowmotty.blogspot.com/)
 *
 */
;(function(b,u,s){b.jatt=function(v){var e,q,r=[],t=b("body"),g=b(s),m=b(u),d=b.extend({},b.jatt.defaultOptions,v);b.jatt.ttrelocate=function(e,w){var k=b("#"+w),a=k.outerWidth(),f=k.outerHeight(),c=k.data("options")||d,p={e:[c.xOffset,-f/2,a+c.xOffset,f/2],se:[c.xOffset,c.yOffset,a+c.xOffset,f+c.yOffset],s:[-a/2,c.yOffset,a/2,f+c.yOffset],sw:[-a-c.xOffset,c.yOffset,-c.xOffset,f+c.yOffset],w:[-a-c.xOffset,-f/2,-c.xOffset,f/2],nw:[-a-c.xOffset,-f-c.yOffset,-c.xOffset,-c.yOffset],n:[-a/2,-f-c.yOffset, a/2,-c.yOffset],ne:[c.xOffset,-f-c.yOffset,a+c.xOffset,-c.yOffset]}[c.direction],n=m.scrollTop(),g=m.scrollLeft(),j=b(e.target),h=e.pageX||j.position().left+j.width()/2,l=e.pageY||j.position().top+j.height()/2;c.followMouse||(h=j.outerWidth(),l=j.outerHeight(),l={e:[h,l/2],se:[h,l],s:[h/2,l],sw:[0,l],w:[0,l/2],nw:[0,0],n:[h/2,0],ne:[h,0]},h=j.offset().left+l[c.direction][0],l=j.offset().top+l[c.direction][1]);var j=h+p[0],o=l+p[1];h+p[2]>g+m.width()-c.xOffset&&(j=m.width()-a-c.xOffset);l+p[3]>n+m.height()- c.yOffset&&(o=l-f-c.yOffset);j<g+c.xOffset&&(j=g+c.xOffset);o<n+c.yOffset&&(o=l+c.yOffset);h>j&&h<j+a&&l>o&&l<o+f&&(o+=o-f/2-c.yOffset<n+c.yOffset?f/2+c.yOffset:-f/2-c.yOffset);k.css({left:j+"px",top:o+"px"})};b.jatt.getMeta=function(i){e=b.extend({},d);var g,k=[],a=i.attr(d.metadata)||"",a=a.match(/(\{.*\})/g)?a.match(/(\{.*\})/g)[0]:i.attr(d.metadata)||"",a=a.match("width|background|color|border|direction|followMouse|content|speed|local|xOffset|yOffset|zIndex")?a:i.attr("data-jatt")||"";""!==a&& (a=a.replace(/(\{|\'|\"|\})/g,""),a.match("direction|followMouse|content|speed|local|xOffset|yOffset|zIndex")&&(b.each(a.split(";"),function(a,c){g=c.split(":");if(g[0].match("direction|followMouse|content|speed|local|xOffset|yOffset|zIndex")){var d=b.trim(g[0]),i=b.trim(g[1]);e[d]="true"==i||"false"==i?"true"==i?!0:!1:isNaN(i)?i:parseFloat(i)}else k.push(c)}),a=k.join(";")));return[e,a]};b.jatt.removeTooltips=function(){var e=b("#"+d.previewId+", #"+d.tooltipId);e.length&&(e.remove(),g.trigger("hidden.jatt", b.data(g,"jatt")));for(;0<b("#"+d.previewId+", #"+d.tooltipId).length;)b("#"+d.previewId+", #"+d.tooltipId).remove()};b.jatt.preloadContent=function(e){if(0!==e.length){var g,k,a,f,c,p=[],n=b(d.tooltip);for(c=e.length;-1<c;c--)g=s.createElement("img"),g.src=e[c],r.push(g);n.each(function(c){k=b(this);"A"===this.tagName&&k.is(d.preloadContent)&&(f=b(this).attr("href")||"",""!==f&&!f.match(/^#/)&&(a=b('<div rel="'+c+'" />'),p.push(a),a.load(f,function(){n.eq(a.attr(d.extradata)).data("tooltip",a.html())})))})}}; (function(){var i=d.live?"live":"bind",m=[];b.each(["initialized.jatt","beforeReveal.jatt","revealed.jatt","hidden.jatt"],function(e,a){var f=a.split(".")[0];b.isFunction(d[f])&&g.bind(a,d[f])});b.data(g,"jatt","");b(d.tooltip)[i](d.activate,function(k){var a,f,c,i,n,m,j,h=b(this);a="false"===d.metadata.toString()?[d,""]:b.jatt.getMeta(h);this!==b.data(g,"jatt")[0]&&b.jatt.removeTooltips();g.trigger("initialized.jatt",h);e=a[0];f=""===h.attr(e.content)?h.data("tooltip")||"":h.attr(e.content)||""; i=h.attr(d.extradata)||"";n=h.attr("href")||"";h.data("tooltip",f);h.attr("title","");a='<div id="'+d.tooltipId+'" style="position:absolute;z-index:'+e.zIndex+";"+a[1]+'"><span class="body"></span><span class="close" style="display:none;">x</span></div>';e.local?h.before(a):t.append(a);c=b("#"+d.tooltipId);""===f&&(""!==i?f=b(i).html()||d.notFound:""!==n&&"#"!==n&&(f=d.loading,m=b("<div />"),m.load(n,function(){j=m.html();r=d.cacheData?j:"";c.hide().find(".body").html(j);h.data("tooltip",r);b.jatt.ttrelocate(k, d.tooltipId);c.fadeIn(e.speed)})));c.data("options",e).find(".body").html(f);b.jatt.ttrelocate(k,d.tooltipId);c.find(".close")[h.is(d.sticky)?"show":"hide"]().click(function(){b.jatt.removeTooltips()});b.data(g,"jatt",h);g.trigger("beforeReveal.jatt",h);c.fadeIn(e.speed);g.trigger("revealed.jatt",h)})[i](d.deactivate,function(){b(this).is(d.sticky)||b.jatt.removeTooltips()})[i]("mousemove",function(k){b("#"+d.tooltipId).length&&e.followMouse&&b.jatt.ttrelocate(k,d.tooltipId)});q=function(k,a,f){g.trigger("initialized.jatt", a);var c,i="false"==d.metadata.toString()?[d,""]:b.jatt.getMeta(a);e=i[0];c=""===a.attr(e.content)?a.data("tooltip")||"":a.attr(e.content)||"";a.data("tooltip",c);"title"===e.content&&a.attr(e.content,"");f='<div id="'+d.previewId+'" style="position:absolute;z-index:'+e.zIndex+";"+i[1]+'"><span class="body"><img src="'+f+(""!==c?"<br/>"+c:"")+'</span><span class="close" style="display:none;">x</span></div>';e.local?a.before(f):t.append(f);f=b("#"+d.previewId);b.data(g,"jatt",a);g.trigger("beforeReveal.jatt", a);f.hide().data("options",e).fadeIn(e.speed);f.find(".close")[a.is(d.sticky)?"show":"hide"]().click(function(){b.jatt.removeTooltips()});b.jatt.ttrelocate(k,d.previewId);g.trigger("revealed.jatt",a)};b(d.preview)[i](d.activate,function(e){var a=b(this);b.jatt.removeTooltips();q(e,a,a.attr("href")+'" alt="'+d.imagePreview+'" />')}).each(function(){m.push(b(this).attr("href"))});b(d.screenshot)[i](d.activate,function(e){var a=b(this),f=("#"===a.attr(d.extradata)?d.websitePreview+a.attr("href"):a.attr(d.extradata))+ '" alt="'+d.siteScreenshot+a.attr("href")+'" />';b.jatt.removeTooltips();q(e,a,f)}).each(function(){var e=b(this);m.push("#"===e.attr(d.extradata)?d.websitePreview+e.attr("href"):e.attr(d.extradata))});b(d.preview+","+d.screenshot)[i](d.deactivate,function(){b(this).is(d.sticky)||b.jatt.removeTooltips()})[i]("mousemove",function(g){b("#"+d.previewId).length&&e.followMouse&&b.jatt.ttrelocate(g,d.previewId)});b.jatt.preloadContent(m)})()};b.jatt.defaultOptions={direction:"n",followMouse:!0,content:"title", speed:300,local:!1,xOffset:20,yOffset:20,zIndex:1E3,live:!1,metadata:"class",extradata:"rel",activate:"mouseenter focusin",deactivate:"mouseleave focusout",cacheData:!0,websitePreview:"http://api1.thumbalizr.com/?width=250&url=",loading:"Loading...",notFound:"No tooltip found",imagePreview:"Image preview",siteScreenshot:"URL preview: ",tooltip:".tooltip",screenshot:"a.screenshot",preview:"a.preview",preloadContent:".preload",sticky:".sticky",tooltipId:"tooltip",previewId:"preview"}})(jQuery,this, document);
